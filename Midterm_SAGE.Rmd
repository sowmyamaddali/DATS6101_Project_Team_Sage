---
title: "BRAIN STROKE PREDICTION"
team:  "SAGE"

---

Brain Stroke:

A stroke is a medical condition in which poor blood flow to the brain causes cell death. According to the World Health Organization (WHO) stroke is the 2nd leading cause of death globally, responsible for approximately 11% of total deaths.

Dataset Link: https://www.kaggle.com/datasets/fedesoriano/stroke-prediction-dataset


```{r}

stroke_df = read.csv("healthcare-dataset-stroke-data.csv")
stroke_df = subset(stroke_df, select = -c(id))
head(stroke_df)

# Getting the summary of the dataframe
summary(stroke_df)


# Looking at the structure of the Dataframe
str(stroke_df)

```
```{r}
# changing the variables to categorical variables and numerical variables
stroke_df$gender <- as.factor(stroke_df$gender)
stroke_df$hypertension <- as.factor(stroke_df$hypertension)
stroke_df$heart_disease <- as.factor(stroke_df$heart_disease)
stroke_df$ever_married <- as.factor(stroke_df$ever_married)
stroke_df$bmi <- as.numeric(stroke_df$bmi)
stroke_df$stroke<- as.factor(stroke_df$stroke)
str(stroke_df)

# Finding if there are any NA's in the dataset
paste("The NA's in the dataset is:",sum(is.na(stroke_df)))
summary(stroke_df)

```
```{r}
# There are 201 NA's in BMI. Replacing those variables with mean of BMI
stroke_df$bmi[is.na(stroke_df$bmi)] <- mean(stroke_df$bmi,na.rm = TRUE)
# Finding if there are any NA's after imputation of null values
paste("The NA's in the dataset is:",sum(is.na(stroke_df)))
```

```{r}

df<-table(stroke_df$stroke)

barplot(df,main='Distribution of Target Variable (Stroke)',col=c('orange','red'))


```

So from the plot, we can see that the number of observations of 0 is greater than the number of observations 1. From this we can see that the dataset is imbalanced.

```{r}
dat=table(stroke_df$stroke,stroke_df$smoking_status)
barplot(dat,
main = "People segregated based on their smoking habbits",
xlab = "Smoking status",
ylab = "Number of people",
col = c("Green","red"),
beside = TRUE
)

```





```{r}

#Pie Plot for Rural VS URBAN

library(plotrix)
df2<-table(stroke_df$Residence_type)
lab<-c('Rural','Urban')
pie3D(df2,explode=0.2,main="Pie Chart of Residence_type ",labels = lab)


```

```{r}

# Compare residence type with stroke 
tab1 = table(stroke_df$Residence_type, stroke_df$stroke)
names(dimnames(tab1))<- c("Work Type", "Stroke")
tab1
```

So we can see that people in Rural area with no effect of brain stroke is 2400 and 2461 in Urban
Rural area people with brain stroke is 114 and 135 in Urban.


```{r}

resi=table(stroke_df$stroke,stroke_df$Residence_type)
barplot(resi,
main = "Distribution of Resident People affected by Brain Stroke",
xlab = "Residence_type",
ylab = "Number of people",
col = c("Red","Orange"),
beside = TRUE
)

```


```{r}

set.seed(123)
ind <- sample(2, nrow(stroke_df), replace = TRUE, prob = c(0.6, 0.4))
train <- stroke_df[ind==1,]
test <- stroke_df[ind==2,]

table(train$stroke)


```
```{r}


stroke_df$work_type <- as.numeric(factor(stroke_df$work_type))

head(stroke_df)




```






```{r}


stroke_df$Residence_type <- as.numeric(factor(stroke_df$Residence_type))

head(stroke_df)


```
```{r}

# Checking Test of Independence between Residence_type and Target Variable Stroke
#alpha =0.05

ch<-table(stroke_df$Residence_type, stroke_df$stroke)  

chisq.test(stroke_df$Residence_type, stroke_df$stroke)






ch2<-table(stroke_df$work_type, stroke_df$stroke)  

chisq.test(stroke_df$work_type, stroke_df$stroke)

format.pval(pv =5.398e-10, 

             # digits : number of digits, but after the 0.0
            digits = 2, 

             # eps = the threshold value above wich the 
             # function will replace the pvalue by "<0.0xxx"
            eps = 0.001, 

             # nsmall = how much tails 0 to keep if digits of 
             # original value < to digits defined
            nsmall = 3
            )


```
Residence_Type is independent to target variable



```{r}


set.seed(123)
ind <- sample(2, nrow(stroke_df), replace = TRUE, prob = c(0.6, 0.4))
train <- stroke_df[ind==1,]
test <- stroke_df[ind==2,]

table(stroke_df$stroke)

```

```{r}
install.packages("ROSE")
```



```{r}
# UNDER AND OVER SAMPLING - BOTH

library(ROSE)

both <- ovun.sample(stroke~., data=train, method = "both",
                    p = 0.5,
                    seed = 222,
                    N = 285)$data

r<-table(both$stroke)
r

```


```{r}

# UNDER AND OVER SAMPLING TECHNIQUE
barplot(r,col='gold')


```
SO after using sampling technqiue we can see that there are 134 cases of no stroke and 151 cases of stroke cases.

