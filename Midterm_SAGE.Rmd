---
title: "BRAIN STROKE PREDICTION"
team:  "SAGE"

---

Brain Stroke:

A stroke is a medical condition in which poor blood flow to the brain causes cell death. According to the World Health Organization (WHO) stroke is the 2nd leading cause of death globally, responsible for approximately 11% of total deaths.

Dataset Link: https://www.kaggle.com/datasets/fedesoriano/stroke-prediction-dataset


```{r}
library(ggplot2)
stroke_df = read.csv("healthcare-dataset-stroke-data.csv")
stroke_df = subset(stroke_df, select = -c(id))
head(stroke_df)

# Getting the summary of the dataframe
summary(stroke_df)


# Looking at the structure of the Dataframe
str(stroke_df)

```
```{r}
# changing the variables to categorical variables and numerical variables
stroke_df$gender <- as.factor(stroke_df$gender)
stroke_df$hypertension <- as.factor(stroke_df$hypertension)
stroke_df$heart_disease <- as.factor(stroke_df$heart_disease)
stroke_df$ever_married <- as.factor(stroke_df$ever_married)
stroke_df$bmi <- as.numeric(stroke_df$bmi)
stroke_df$stroke<- as.factor(stroke_df$stroke)
str(stroke_df)

# Finding if there are any NA's in the dataset
paste("The NA's in the dataset is:",sum(is.na(stroke_df)))
summary(stroke_df)

```
```{r}
# There are 201 NA's in BMI. Replacing those variables with mean of BMI
stroke_df$bmi[is.na(stroke_df$bmi)] <- mean(stroke_df$bmi,na.rm = TRUE)
# Finding if there are any NA's after imputation of null values
paste("The NA's in the dataset is:",sum(is.na(stroke_df)))
```

```{r}

df<-table(stroke_df$stroke)

barplot(df,main='Distribution of Target Variable (Stroke)',col=c('orange','red'))


```

So from the plot, we can see that the number of observations of 0 is greater than the number of observations 1. From this we can see that the dataset is imbalanced.

```{r}
dat=table(stroke_df$stroke,stroke_df$smoking_status)
barplot(dat,
main = "People segregated based on their smoking habbits",
xlab = "Smoking status",
ylab = "Number of people",
col = c("Green","red"),
beside = TRUE
)

```
```{r}

#Pie Plot for Rural VS URBAN

library(plotrix)
df2<-table(stroke_df$Residence_type)
lab<-c('Rural','Urban')
pie3D(df2,explode=0.2,main="Pie Chart of Residence_type ",labels = lab)


```

```{r}

# Compare residence type with stroke 
tab1 = table(stroke_df$Residence_type, stroke_df$stroke)
names(dimnames(tab1))<- c("Work Type", "Stroke")
tab1
```

So we can see that people in Rural area with no effect of brain stroke is 2400 and 2461 in Urban
Rural area people with brain stroke is 114 and 135 in Urban.


```{r}

resi=table(stroke_df$stroke,stroke_df$Residence_type)
barplot(resi,
main = "Distribution of Resident People affected by Brain Stroke",
xlab = "Residence_type",
ylab = "Number of people",
col = c("Red","Orange"),
beside = TRUE
)

```
```{r}
# Count of Males and Females in the Dataset
ggplot(stroke_df, aes(x=gender,fill=gender))+geom_bar()+ggtitle("Count of Male and Female in the Dataset")+ theme_bw() +
  theme()+ xlab("Gender") + ylab("Count of people")
# Seeing if work type affects people
ggplot(stroke_df,aes(x=work_type, fill=stroke))+geom_bar(position = "dodge")+ggtitle("Work Type Vs Stroke")+ theme_bw() +
  theme()+ xlab("Work Type") + ylab("Count of people who had a stroke")
# Seeing if Smoking status causes stroke
ggplot(stroke_df,aes(x=smoking_status, fill=stroke))+geom_bar(position = "dodge")+ggtitle("Smoking status Vs Stroke")+ theme_bw() + theme()+ xlab("Smoking Status") + ylab("Count of people who had a stroke")
```
```{r}
# Bmi distribution
ggplot( stroke_df,aes(x=bmi)) + geom_density(fill="#69b3a2", color="#e9ecef", alpha=0.8)+ theme_bw() + theme()+ ggtitle("BMI distribution")
# BMI vs stroke 
ggplot(stroke_df, aes(x=bmi, fill=stroke)) + geom_histogram( color="#e9ecef", alpha=0.6, position = 'identity')+ theme_bw() + theme()
```
