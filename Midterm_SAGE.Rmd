---
title: "BRAIN STROKE PREDICTION"
team:  "SAGE"

---

Brain Stroke:

A stroke is a medical condition in which poor blood flow to the brain causes cell death. According to the World Health Organization (WHO) stroke is the 2nd leading cause of death globally, responsible for approximately 11% of total deaths.

Dataset Link: https://www.kaggle.com/datasets/fedesoriano/stroke-prediction-dataset


```{r}

stroke_df = read.csv("healthcare-dataset-stroke-data.csv")
stroke_df = subset(stroke_df, select = -c(id))
head(stroke_df)

# Getting the summary of the dataframe
summary(stroke_df)


# Looking at the structure of the Dataframe
str(stroke_df)

```
```{r}
# changing the variables to categorical variables and numerical variables
stroke_df$gender <- as.factor(stroke_df$gender)
stroke_df$hypertension <- as.factor(stroke_df$hypertension)
stroke_df$heart_disease <- as.factor(stroke_df$heart_disease)
stroke_df$ever_married <- as.factor(stroke_df$ever_married)
stroke_df$bmi <- as.numeric(stroke_df$bmi)
stroke_df$stroke<- as.factor(stroke_df$stroke)
str(stroke_df)

# Finding if there are any NA's in the dataset
paste("The NA's in the dataset is:",sum(is.na(stroke_df)))
summary(stroke_df)

```
```{r}
# There are 201 NA's in BMI. Replacing those variables with mean of BMI
stroke_df$bmi[is.na(stroke_df$bmi)] <- mean(stroke_df$bmi,na.rm = TRUE)
# Finding if there are any NA's after imputation of null values
paste("The NA's in the dataset is:",sum(is.na(stroke_df)))
```

```{r}

df<-table(stroke_df$stroke)

barplot(df,main='Distribution of Target Variable (Stroke)',col=c('orange','red'))


```

So from the plot, we can see that the number of observations of 0 is greater than the number of observations 1. From this we can see that the dataset is imbalanced.

```{r}
dat=table(stroke_df$stroke,stroke_df$smoking_status)
barplot(dat,
main = "People segregated based on their smoking habbits",
xlab = "Smoking status",
ylab = "Number of people",
col = c("Green","red"),
beside = TRUE
)

```
```{r}

#Pie Plot for Rural VS URBAN

library(plotrix)
df2<-table(stroke_df$Residence_type)
lab<-c('Rural','Urban')
pie3D(df2,explode=0.2,main="Pie Chart of Residence_type ",labels = lab)


```

```{r}

# Compare residence type with stroke 
tab1 = table(stroke_df$Residence_type, stroke_df$stroke)
names(dimnames(tab1))<- c("Work Type", "Stroke")
tab1
```

So we can see that people in Rural area with no effect of brain stroke is 2400 and 2461 in Urban
Rural area people with brain stroke is 114 and 135 in Urban.


```{r}

resi=table(stroke_df$stroke,stroke_df$Residence_type)
barplot(resi,
main = "Distribution of Resident People affected by Brain Stroke",
xlab = "Residence_type",
ylab = "Number of people",
col = c("Red","Orange"),
beside = TRUE
)




```

#```{r}
#marriage=table(stroke_df$stroke,stroke_df$ever_married)
#barplot(marriage,
#main = "Distribution of Married People affected by Brain Stroke",
#xlab = "Residence_type",
#ylab = "Number of people",
#col = c("blue","yellow"),
#beside = TRUE
#)
#```


```{r}
marriage_table = table(stroke_df$ever_married, stroke_df$stroke)
names(dimnames(marriage_table))<- c("Marital status", "Stroke")
marriage_table
```
Here we can see that the data available is that People who are not married and who can get stroke are only 29 and that is 220 for married people.

```{r}
barplot(height = marriage_table, beside = TRUE)
```
Observation with 0 are more greater than 1 so we can say it is an imbalanced data.

*Pie Chart for the ever-marriage feature*

```{r}
library(plotrix)
df3 <- table(stroke_df$ever_married) 
lbls <- c("Yes","No")
pie3D(df3,labels=lbls,explode=0.12,height = 0.18,
   main="Pie Chart of marital status ")


```


```{r}
#Age is not a categorical and it is the the numerical data type so lets find out the maximum and minimum of the age first.
summary(stroke_df$age)

```
*To give it in a pictorial way we can use the box-plot to get all these above values based on the stroke result.*
```{r}
library(ggplot2)
ggplot(stroke_df, aes(y=stroke , x=age, fill=stroke )) + 
  geom_boxplot()

```



```{r}
hist(stroke_df$age, main = "Histogram for Age", xlab = "Age")
sort(stroke_df$age)
```

*We can build some buckets to convert these numerical data into a categorical type data so that it is very easy to explore the data.*

```{r}
dat <- within(stroke_df, {   
  age.cat <- NA # need to initialize variable
  age.cat[age < 20] <- "Below 20"
  age.cat[age >= 20 & age < 40] <- "Below 40"
  age.cat[age >= 40 &age < 60] <- "Below 60"
  age.cat[age >= 60 &age < 83] <- "Below 83" # As maximum value is 82
   } )

#str(dat)

dat$age.cat<- as.factor(dat$age.cat)
str(dat)
```

```{r}
Age_category=table(dat$stroke,dat$age.cat)
barplot(Age_category,
main = "Distribution of different age People affected by Brain Stroke",
xlab = "Age_category",
ylab = "Number of people",
col = c("blue","yellow"),
beside = TRUE
)
```

```{r}
age_table = table(dat$age.cat, dat$stroke)
names(dimnames(age_table))<- c("Age", "Stroke")
age_table

```
*From this distribution we can say that the people with stroke are of more with age 60 and 80 than compared with 20 and 40*



```{r}
#Same as Age now Avg_glucose_level is not a categorical and it is the the numerical data type so lets find out the maximum and minimum of the avg_glucose_level first.
summary(stroke_df$avg_glucose_level)

```

```{r}
library(ggplot2)
ggplot(stroke_df, aes(y=stroke , x=avg_glucose_level, fill=stroke )) + 
  geom_boxplot()

```

```{r}
hist(stroke_df$avg_glucose_level, main = "Histogram for Glucose level", xlab = "Glucose level")
sort(stroke_df$avg_glucose_level)
```


```{r}
dat_gluc <- within(stroke_df, {   
  avg_gluc.cat <- NA # need to initialize variable
  avg_gluc.cat[avg_glucose_level < 60] <- "Below 60"
  avg_gluc.cat[avg_glucose_level >= 60 & avg_glucose_level < 90] <- "Below 90"
  avg_gluc.cat[avg_glucose_level >= 90 & avg_glucose_level < 140] <- "Below 140"
  avg_gluc.cat[avg_glucose_level >= 140 & avg_glucose_level < 273] <- "Below 273" 
   } )

#str(dat)

dat_gluc$avg_gluc.cat <- factor(dat_gluc$avg_gluc.cat, levels= c("Below 60", "Below 90", "Below 140", "Below 273"))
```
```{r}
Avg_glucose_category=table(dat_gluc$stroke,dat_gluc$avg_gluc.cat)
barplot(Avg_glucose_category,
main = "Distribution of different age People affected by Brain Stroke",
xlab = "Avg_glucose_category",
ylab = "Number of people",
col = c("blue","yellow"),
beside = TRUE
)
```
```{r}
avg_gluc_table = table(dat_gluc$avg_gluc.cat, dat_gluc$stroke)
names(dimnames(avg_gluc_table))<- c("Age", "Stroke")
avg_gluc_table

```
*People with Avg_glucose level below 273 to 90 have higher chance of getting stroke.*


*Trying to find some relation between the features.*
```{r}
library(ggplot2)
ggplot(stroke_df, aes(x=ever_married, y=age, fill=stroke )) + 
  geom_boxplot()
```
``` {r}

#Comparing age with different buckets with respecct to stroke and viewing it on a boxplot
ggplot(dat, aes(fill = stroke, y = age, x = age.cat)) + geom_boxplot()

#using the boxplot to see the stroke for different age people with respecc to their glucose level.
ggplot(dat_gluc, aes(fill=stroke, y = age, x = avg_gluc.cat))+ geom_boxplot()

```
```{r}
#comparing stroke with different age people based on their smoking habit.
ggplot(dat, aes(x= stroke, fill = smoking_status, y = age)) + geom_boxplot()

```



```{r}
#Pie chart for marital status
library(plotly)
fig <- plot_ly(stroke_df, labels = stroke_df$ever_married, values = stroke_df$stroke, type = 'pie')
fig <- fig %>% layout(title = 'Marital Status for stroke prediction',
         xaxis = list(showgrid = FALSE, zeroline = FALSE, showticklabels = FALSE),
         yaxis = list(showgrid = FALSE, zeroline = FALSE, showticklabels = FALSE))

fig
```

















